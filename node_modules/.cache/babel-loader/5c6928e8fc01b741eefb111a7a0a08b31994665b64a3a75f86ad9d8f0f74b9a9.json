{"ast":null,"code":"import _classPrivateFieldLooseBase from \"/Users/wonholee/Desktop/webDev/outsourcing/elice/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseBase.js\";\nimport _classPrivateFieldLooseKey from \"/Users/wonholee/Desktop/webDev/outsourcing/elice/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseKey.js\";\nvar _storage, _key;\n/* ========================================================\n * !!! 주의 !!!\n * 해당 파일은 엘리스 외부 콘텐츠 프로젝트의 주요 부분이며, 허가 없이 수정할 수 없습니다.\n * 이와 관련하여 질문이 있으시면 연락 주시기 바랍니다.\n *\n * !!! Warning !!!\n * This file is core part of the Elice external contents project,\n * and should not be modified without permission.\n * If you have any questions, please contact us via contact point.\n * ======================================================== */\n\nimport { camelizeKeys } from 'humps';\nimport { jwtDecode } from 'jwt-decode';\n\n//\n//\n//\n\n/**\n * Payload of external token (`extToken` at query string)\n */\n//\n//\n//\n/**\n * decode external token.\n */\nexport function decodeExtToken(extToken) {\n  return jwtDecode(extToken);\n}\n\n/**\n * storage for external token payload.\n */\nexport const EliceExtTokenStorage = new (_storage = /*#__PURE__*/_classPrivateFieldLooseKey(\"storage\"), _key = /*#__PURE__*/_classPrivateFieldLooseKey(\"key\"), class ExtTokenStorage {\n  constructor() {\n    Object.defineProperty(this, _storage, {\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, _key, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldLooseBase(this, _storage)[_storage] = sessionStorage;\n    _classPrivateFieldLooseBase(this, _key)[_key] = `elice.matext.exttoken`;\n  }\n\n  /**\n   * get external token payload.\n   */\n  get() {\n    const raw = _classPrivateFieldLooseBase(this, _storage)[_storage].getItem(_classPrivateFieldLooseBase(this, _key)[_key]);\n    const parsed = raw ? JSON.parse(raw) : {};\n    return parsed.iss === 'elice-api' ? parsed : null;\n  }\n\n  /**\n   * set external token payload.\n   */\n  set(value) {\n    _classPrivateFieldLooseBase(this, _storage)[_storage].setItem(_classPrivateFieldLooseBase(this, _key)[_key], JSON.stringify(camelizeKeys(value)));\n  }\n\n  /**\n   * set external token payload from external token.\n   */\n  setToken(extToken) {\n    const payload = decodeExtToken(extToken);\n    this.set(payload);\n  }\n\n  /**\n   * remove external token payload.\n   */\n  remove() {\n    _classPrivateFieldLooseBase(this, _storage)[_storage].removeItem(_classPrivateFieldLooseBase(this, _key)[_key]);\n  }\n})();","map":{"version":3,"names":["camelizeKeys","jwtDecode","decodeExtToken","extToken","EliceExtTokenStorage","_storage","_classPrivateFieldLooseKey","_key","ExtTokenStorage","constructor","Object","defineProperty","writable","value","_classPrivateFieldLooseBase","sessionStorage","get","raw","getItem","parsed","JSON","parse","iss","set","setItem","stringify","setToken","payload","remove","removeItem"],"sources":["/Users/wonholee/Desktop/webDev/outsourcing/elice/src/elice/utils/token.ts"],"sourcesContent":["/* ========================================================\n * !!! 주의 !!!\n * 해당 파일은 엘리스 외부 콘텐츠 프로젝트의 주요 부분이며, 허가 없이 수정할 수 없습니다.\n * 이와 관련하여 질문이 있으시면 연락 주시기 바랍니다.\n *\n * !!! Warning !!!\n * This file is core part of the Elice external contents project,\n * and should not be modified without permission.\n * If you have any questions, please contact us via contact point.\n * ======================================================== */\n\nimport { camelizeKeys } from 'humps';\nimport { jwtDecode } from 'jwt-decode';\n\n//\n//\n//\n\n/**\n * Payload of external token (`extToken` at query string)\n */\nexport interface EliceExtTokenPayload {\n  iss: 'elice-api';\n  ts: number;\n  uid: null;\n  /**\n   * Elice user ID.\n   *\n   * @example 123456\n   */\n  userId: string;\n  /**\n   * URL to post progress.\n   *\n   * @example 'https://api-esp-proxy.elice.io/default/progress/external?token=eyJhbGciO...XMBzpWggKKlv1-1o'\n   */\n  progressUrl: string;\n  /**\n   * Elice user ID of the tutor.\n   * (present only if the user is a tutor at tutoring mode)\n   *\n   * @example 123456\n   */\n  tutorUserId?: number;\n}\n\n//\n//\n//\n\n/**\n * decode external token.\n */\nexport function decodeExtToken(extToken: string) {\n  return jwtDecode<EliceExtTokenPayload>(extToken);\n}\n\n/**\n * storage for external token payload.\n */\nexport const EliceExtTokenStorage = new (class ExtTokenStorage {\n  #storage: Storage;\n  #key: string;\n\n  constructor() {\n    this.#storage = sessionStorage;\n    this.#key = `elice.matext.exttoken`;\n  }\n\n  /**\n   * get external token payload.\n   */\n  get() {\n    const raw = this.#storage.getItem(this.#key);\n    const parsed = raw ? JSON.parse(raw) : {};\n    return parsed.iss === 'elice-api' ? (parsed as EliceExtTokenPayload) : null;\n  }\n\n  /**\n   * set external token payload.\n   */\n  set(value: EliceExtTokenPayload) {\n    this.#storage.setItem(this.#key, JSON.stringify(camelizeKeys(value)));\n  }\n\n  /**\n   * set external token payload from external token.\n   */\n  setToken(extToken: string) {\n    const payload = decodeExtToken(extToken);\n    this.set(payload);\n  }\n\n  /**\n   * remove external token payload.\n   */\n  remove() {\n    this.#storage.removeItem(this.#key);\n  }\n})();\n"],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASA,YAAY,QAAQ,OAAO;AACpC,SAASC,SAAS,QAAQ,YAAY;;AAEtC;AACA;AACA;;AAEA;AACA;AACA;AA0BA;AACA;AACA;AAEA;AACA;AACA;AACA,OAAO,SAASC,cAAcA,CAACC,QAAgB,EAAE;EAC/C,OAAOF,SAAS,CAAuBE,QAAQ,CAAC;AAClD;;AAEA;AACA;AACA;AACA,OAAO,MAAMC,oBAAoB,GAAG,KAAAC,QAAA,gBAAAC,0BAAA,aAAAC,IAAA,gBAAAD,0BAAA,SAAK,MAAME,eAAe,CAAC;EAI7DC,WAAWA,CAAA,EAAG;IAAAC,MAAA,CAAAC,cAAA,OAAAN,QAAA;MAAAO,QAAA;MAAAC,KAAA;IAAA;IAAAH,MAAA,CAAAC,cAAA,OAAAJ,IAAA;MAAAK,QAAA;MAAAC,KAAA;IAAA;IACZC,2BAAA,KAAI,EAAAT,QAAA,EAAAA,QAAA,IAAYU,cAAc;IAC9BD,2BAAA,KAAI,EAAAP,IAAA,EAAAA,IAAA,IAAS,uBAAsB;EACrC;;EAEA;AACF;AACA;EACES,GAAGA,CAAA,EAAG;IACJ,MAAMC,GAAG,GAAGH,2BAAA,KAAI,EAAAT,QAAA,EAAAA,QAAA,EAAUa,OAAO,CAAAJ,2BAAA,CAAC,IAAI,EAAAP,IAAA,EAAAA,IAAA,CAAK,CAAC;IAC5C,MAAMY,MAAM,GAAGF,GAAG,GAAGG,IAAI,CAACC,KAAK,CAACJ,GAAG,CAAC,GAAG,CAAC,CAAC;IACzC,OAAOE,MAAM,CAACG,GAAG,KAAK,WAAW,GAAIH,MAAM,GAA4B,IAAI;EAC7E;;EAEA;AACF;AACA;EACEI,GAAGA,CAACV,KAA2B,EAAE;IAC/BC,2BAAA,KAAI,EAAAT,QAAA,EAAAA,QAAA,EAAUmB,OAAO,CAAAV,2BAAA,CAAC,IAAI,EAAAP,IAAA,EAAAA,IAAA,GAAOa,IAAI,CAACK,SAAS,CAACzB,YAAY,CAACa,KAAK,CAAC,CAAC,CAAC;EACvE;;EAEA;AACF;AACA;EACEa,QAAQA,CAACvB,QAAgB,EAAE;IACzB,MAAMwB,OAAO,GAAGzB,cAAc,CAACC,QAAQ,CAAC;IACxC,IAAI,CAACoB,GAAG,CAACI,OAAO,CAAC;EACnB;;EAEA;AACF;AACA;EACEC,MAAMA,CAAA,EAAG;IACPd,2BAAA,KAAI,EAAAT,QAAA,EAAAA,QAAA,EAAUwB,UAAU,CAAAf,2BAAA,CAAC,IAAI,EAAAP,IAAA,EAAAA,IAAA,CAAK,CAAC;EACrC;AACF,CAAC,EAAE,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}